<html>
<style>
body { 
  font-family: Helvetica;
  font-size: xx-large;
  padding: 2em;
}
</style>
<body>
<h3><code><pre>

var lexer = new Lexer();

lexer.addRule(/push/, function () {
    return "PUSH";
});

lexer.addRule(/add/, function () {
    return "ADD";
});

/* ... */


  var stack = [];
  var push = false;

  while (token = lexer.lex()) {
    switch (token) {
      case "NUMBER":
        if (push) {
          stack.push(lexer.yytext);
        } else {
          alert("Unexpected number.");
        }
        break;
      case "ADD":
        if (push) {
          alert("Expected number.");
        } else {
          stack.push(stack.pop() + stack.pop());
        }
        break;
      case "PRINT":
        if (push) {
          alert("Expected number.");
        } else {
          printLn(stack.pop());
        }
        break;
      case "ROT":
        // ( x1 x2 x3 -- x2 x3 x1 )
        stack.push(stack.shift());
        break;
      case "COUNTDO":
        break;
      case "LOOP":
        break;
      case "OVER":
        // (a b -- a b a )
        var a = stack.pop();
        var b = stack.pop();
        stack.push(a);
        stack.push(b);
        stack.push(a);
        break;
      case "SWAP":
        // (a b -- b a)
        var a = stack.pop();
        var b = stack.pop();
        stack.push(b);
        stack.push(a);
        break;
      case "DROP":
        stack.pop();
        break;
    }

    push = token === "PUSH";
  }
}

function printLn(s) {
  var output = $('#output').val();
  $('#output').val(output + "\n" + s);
}

$('#run').click(function(event) {
  event.preventDefault();
  var src = $('#src').val();
  run(src);
});


    
    
    
    </pre></code>
</h3>
</body>
</html>
